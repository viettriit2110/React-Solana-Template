{"ast":null,"code":"import { BaseMessageSignerWalletAdapter, WalletAccountError, WalletConfigError, WalletConnectionError, WalletDisconnectionError, WalletError, WalletLoadError, WalletNotConnectedError, WalletNotReadyError, WalletPublicKeyError, WalletReadyState, WalletSendTransactionError, WalletSignMessageError, WalletSignTransactionError } from '@solana/wallet-adapter-base';\nimport { PublicKey } from '@solana/web3.js';\nexport const TorusWalletName = 'Torus';\nexport class TorusWalletAdapter extends BaseMessageSignerWalletAdapter {\n  constructor() {\n    let {\n      params = {\n        showTorusButton: false\n      }\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n      params: {\n        showTorusButton: false\n      }\n    };\n    super();\n    this.name = TorusWalletName;\n    this.url = 'https://tor.us';\n    this.icon = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzMiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMyAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTYuNSIgY3k9IjE2IiByPSIxNiIgZmlsbD0iIzAzNjRGRiIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTExLjIxODYgOS40OTIxOUMxMC40NTM5IDkuNDkyMTkgOS44MzM5OCAxMC4xMTIxIDkuODMzOTggMTAuODc2OFYxMi40ODk4QzkuODMzOTggMTMuMjU0NSAxMC40NTM5IDEzLjg3NDQgMTEuMjE4NiAxMy44NzQ0SDEzLjY2ODRWMjIuODk3NkMxMy42Njg0IDIzLjY2MjMgMTQuMjg4MyAyNC4yODIyIDE1LjA1MyAyNC4yODIySDE2LjY2NkMxNy40MzA3IDI0LjI4MjIgMTguMDUwNiAyMy42NjIzIDE4LjA1MDYgMjIuODk3NlYxMi41MDE1QzE4LjA1MDYgMTIuNDk3NiAxOC4wNTA2IDEyLjQ5MzcgMTguMDUwNiAxMi40ODk4VjEwLjg3NjhDMTguMDUwNiAxMC4xMTIxIDE3LjQzMDcgOS40OTIxOSAxNi42NjYgOS40OTIxOUgxNS4wNTNIMTEuMjE4NloiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0yMS4zMzc2IDEzLjg3NDRDMjIuNTQ3NyAxMy44NzQ0IDIzLjUyODcgMTIuODkzNCAyMy41Mjg3IDExLjY4MzNDMjMuNTI4NyAxMC40NzMyIDIyLjU0NzcgOS40OTIxOSAyMS4zMzc2IDkuNDkyMTlDMjAuMTI3NSA5LjQ5MjE5IDE5LjE0NjUgMTAuNDczMiAxOS4xNDY1IDExLjY4MzNDMTkuMTQ2NSAxMi44OTM0IDIwLjEyNzUgMTMuODc0NCAyMS4zMzc2IDEzLjg3NDRaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K';\n    this.supportedTransactionVersions = null;\n    this._readyState = typeof window === 'undefined' || typeof document === 'undefined' ? WalletReadyState.Unsupported : WalletReadyState.Loadable;\n    this._connecting = false;\n    this._wallet = null;\n    this._publicKey = null;\n    this._params = params;\n  }\n  get publicKey() {\n    return this._publicKey;\n  }\n  get connecting() {\n    return this._connecting;\n  }\n  get connected() {\n    return !!this._wallet?.isLoggedIn;\n  }\n  get readyState() {\n    return this._readyState;\n  }\n  async connect() {\n    try {\n      if (this.connected || this.connecting) return;\n      if (this._readyState !== WalletReadyState.Loadable) throw new WalletNotReadyError();\n      this._connecting = true;\n      let TorusClass;\n      try {\n        TorusClass = (await import('@toruslabs/solana-embed')).default;\n      } catch (error) {\n        throw new WalletLoadError(error?.message, error);\n      }\n      let wallet;\n      try {\n        wallet = window.torus || new TorusClass();\n      } catch (error) {\n        throw new WalletConfigError(error?.message, error);\n      }\n      if (!wallet.isInitialized) {\n        try {\n          await wallet.init(this._params);\n        } catch (error) {\n          throw new WalletConnectionError(error?.message, error);\n        }\n      }\n      let accounts;\n      try {\n        accounts = await wallet.login();\n      } catch (error) {\n        throw new WalletAccountError(error?.message, error);\n      }\n      let publicKey;\n      try {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        publicKey = new PublicKey(accounts[0]);\n      } catch (error) {\n        throw new WalletPublicKeyError(error?.message, error);\n      }\n      this._wallet = wallet;\n      this._publicKey = publicKey;\n      this.emit('connect', publicKey);\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    } finally {\n      this._connecting = false;\n    }\n  }\n  async disconnect() {\n    const wallet = this._wallet;\n    if (wallet) {\n      this._wallet = null;\n      this._publicKey = null;\n      try {\n        if (wallet.isLoggedIn) await wallet.cleanUp();\n      } catch (error) {\n        this.emit('error', new WalletDisconnectionError(error?.message, error));\n      }\n    }\n    this.emit('disconnect');\n  }\n  async sendTransaction(transaction, connection) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    try {\n      const wallet = this._wallet;\n      if (!wallet) throw new WalletNotConnectedError();\n      try {\n        const {\n          signers,\n          ...sendOptions\n        } = options;\n        transaction = await this.prepareTransaction(transaction, connection, sendOptions);\n        signers?.length && transaction.partialSign(...signers);\n        sendOptions.preflightCommitment = sendOptions.preflightCommitment || connection.commitment;\n        const {\n          signature\n        } = await wallet.signAndSendTransaction(transaction, sendOptions);\n        return signature;\n      } catch (error) {\n        if (error instanceof WalletError) throw error;\n        throw new WalletSendTransactionError(error?.message, error);\n      }\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n  async signTransaction(transaction) {\n    try {\n      const wallet = this._wallet;\n      if (!wallet) throw new WalletNotConnectedError();\n      try {\n        return (await wallet.signTransaction(transaction)) || transaction;\n      } catch (error) {\n        throw new WalletSignTransactionError(error?.message, error);\n      }\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n  async signAllTransactions(transactions) {\n    try {\n      const wallet = this._wallet;\n      if (!wallet) throw new WalletNotConnectedError();\n      try {\n        return (await wallet.signAllTransactions(transactions)) || transactions;\n      } catch (error) {\n        throw new WalletSignTransactionError(error?.message, error);\n      }\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n  async signMessage(message) {\n    try {\n      const wallet = this._wallet;\n      if (!wallet) throw new WalletNotConnectedError();\n      try {\n        return await wallet.signMessage(message);\n      } catch (error) {\n        throw new WalletSignMessageError(error?.message, error);\n      }\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n}","map":{"version":3,"mappings":"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","names":["BaseMessageSignerWalletAdapter","WalletAccountError","WalletConfigError","WalletConnectionError","WalletDisconnectionError","WalletError","WalletLoadError","WalletNotConnectedError","WalletNotReadyError","WalletPublicKeyError","WalletReadyState","WalletSendTransactionError","WalletSignMessageError","WalletSignTransactionError","PublicKey","TorusWalletName","TorusWalletAdapter","constructor","params","showTorusButton","window","document","Unsupported","Loadable","_connecting","_wallet","_publicKey","_params","publicKey","connecting","connected","isLoggedIn","readyState","_readyState","connect","TorusClass","default","error","message","wallet","torus","isInitialized","init","accounts","login","emit","disconnect","cleanUp","sendTransaction","transaction","connection","options","signers","sendOptions","prepareTransaction","length","partialSign","preflightCommitment","commitment","signature","signAndSendTransaction","signTransaction","signAllTransactions","transactions","signMessage"],"sourceRoot":"","sources":["../../src/adapter.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}