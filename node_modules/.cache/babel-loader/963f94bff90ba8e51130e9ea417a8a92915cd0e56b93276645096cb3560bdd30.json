{"ast":null,"code":"import { BaseSignerWalletAdapter, WalletConnectionError, WalletDisconnectedError, WalletDisconnectionError, WalletLoadError, WalletNotConnectedError, WalletNotReadyError, WalletPublicKeyError, WalletReadyState, WalletSignTransactionError } from '@solana/wallet-adapter-base';\nimport './polyfills/index.js';\nimport { getDerivationPath, getPublicKey, signTransaction } from './util.js';\nexport const LedgerWalletName = 'Ledger';\nexport class LedgerWalletAdapter extends BaseSignerWalletAdapter {\n  constructor() {\n    let config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    super();\n    this.name = LedgerWalletName;\n    this.url = 'https://ledger.com';\n    this.icon = 'data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMzUgMzUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iI2ZmZiI+PHBhdGggZD0ibTIzLjU4OCAwaC0xNnYyMS41ODNoMjEuNnYtMTZhNS41ODUgNS41ODUgMCAwIDAgLTUuNi01LjU4M3oiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUuNzM5KSIvPjxwYXRoIGQ9Im04LjM0MiAwaC0yLjc1N2E1LjU4NSA1LjU4NSAwIDAgMCAtNS41ODUgNS41ODV2Mi43NTdoOC4zNDJ6Ii8+PHBhdGggZD0ibTAgNy41OWg4LjM0MnY4LjM0MmgtOC4zNDJ6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDUuNzM5KSIvPjxwYXRoIGQ9Im0xNS4xOCAyMy40NTFoMi43NTdhNS41ODUgNS41ODUgMCAwIDAgNS41ODUtNS42di0yLjY3MWgtOC4zNDJ6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMS40NzggMTEuNDc4KSIvPjxwYXRoIGQ9Im03LjU5IDE1LjE4aDguMzQydjguMzQyaC04LjM0MnoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUuNzM5IDExLjQ3OCkiLz48cGF0aCBkPSJtMCAxNS4xOHYyLjc1N2E1LjU4NSA1LjU4NSAwIDAgMCA1LjU4NSA1LjU4NWgyLjc1N3YtOC4zNDJ6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDExLjQ3OCkiLz48L2c+PC9zdmc+';\n    this.supportedTransactionVersions = null;\n    this._readyState = typeof window === 'undefined' || typeof document === 'undefined' || typeof navigator === 'undefined' || !navigator.hid ? WalletReadyState.Unsupported : WalletReadyState.Loadable;\n    this._disconnected = () => {\n      const transport = this._transport;\n      if (transport) {\n        transport.off('disconnect', this._disconnected);\n        this._transport = null;\n        this._publicKey = null;\n        this.emit('error', new WalletDisconnectedError());\n        this.emit('disconnect');\n      }\n    };\n    this._derivationPath = config.derivationPath || getDerivationPath(0, 0);\n    this._connecting = false;\n    this._transport = null;\n    this._publicKey = null;\n  }\n  get publicKey() {\n    return this._publicKey;\n  }\n  get connecting() {\n    return this._connecting;\n  }\n  get readyState() {\n    return this._readyState;\n  }\n  async connect() {\n    try {\n      if (this.connected || this.connecting) return;\n      if (this._readyState !== WalletReadyState.Loadable) throw new WalletNotReadyError();\n      this._connecting = true;\n      let TransportWebHIDClass;\n      try {\n        TransportWebHIDClass = (await import('@ledgerhq/hw-transport-webhid')).default;\n      } catch (error) {\n        throw new WalletLoadError(error?.message, error);\n      }\n      let transport;\n      try {\n        transport = await TransportWebHIDClass.create();\n      } catch (error) {\n        throw new WalletConnectionError(error?.message, error);\n      }\n      let publicKey;\n      try {\n        publicKey = await getPublicKey(transport, this._derivationPath);\n      } catch (error) {\n        throw new WalletPublicKeyError(error?.message, error);\n      }\n      transport.on('disconnect', this._disconnected);\n      this._transport = transport;\n      this._publicKey = publicKey;\n      this.emit('connect', publicKey);\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    } finally {\n      this._connecting = false;\n    }\n  }\n  async disconnect() {\n    const transport = this._transport;\n    if (transport) {\n      transport.off('disconnect', this._disconnected);\n      this._transport = null;\n      this._publicKey = null;\n      try {\n        await transport.close();\n      } catch (error) {\n        this.emit('error', new WalletDisconnectionError(error?.message, error));\n      }\n    }\n    this.emit('disconnect');\n  }\n  async signTransaction(transaction) {\n    try {\n      const transport = this._transport;\n      const publicKey = this._publicKey;\n      if (!transport || !publicKey) throw new WalletNotConnectedError();\n      try {\n        const signature = await signTransaction(transport, transaction, this._derivationPath);\n        transaction.addSignature(publicKey, signature);\n      } catch (error) {\n        throw new WalletSignTransactionError(error?.message, error);\n      }\n      return transaction;\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n}","map":{"version":3,"mappings":"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","names":["BaseSignerWalletAdapter","WalletConnectionError","WalletDisconnectedError","WalletDisconnectionError","WalletLoadError","WalletNotConnectedError","WalletNotReadyError","WalletPublicKeyError","WalletReadyState","WalletSignTransactionError","getDerivationPath","getPublicKey","signTransaction","LedgerWalletName","LedgerWalletAdapter","constructor","config","window","document","navigator","hid","Unsupported","Loadable","transport","_transport","off","_disconnected","_publicKey","emit","_derivationPath","derivationPath","_connecting","publicKey","connecting","readyState","_readyState","connect","connected","TransportWebHIDClass","default","error","message","create","on","disconnect","close","transaction","signature","addSignature"],"sourceRoot":"","sources":["../../src/adapter.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}