{"ast":null,"code":"import { BaseWalletAdapter, WalletAccountError, WalletAdapterNetwork, WalletConfigError, WalletConnectionError, WalletDisconnectionError, WalletError, WalletLoadError, WalletNotConnectedError, WalletNotReadyError, WalletPublicKeyError, WalletReadyState, WalletSendTransactionError } from '@solana/wallet-adapter-base';\nimport { PublicKey } from '@solana/web3.js';\nexport const BloctoWalletName = 'Blocto';\nexport class BloctoWalletAdapter extends BaseWalletAdapter {\n  constructor() {\n    let config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    super();\n    this.name = BloctoWalletName;\n    this.url = 'https://blocto.app';\n    this.icon = 'data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0ibTE5LjQ4MzggMTUuMjQ5Yy4yNzY5IDAgLjUwNDguMjA5OS41MzI1LjQ3ODhsLjAwMjIuMDQyOS0uMDA0My4xMTQyYy0uMzM1IDMuOTgzMy0zLjc5MDQgNy4xMTUxLTguMDAzNyA3LjExNTEtNC4xNzA2IDAtNy41OTg2My0zLjA2ODctNy45OTI2OS02Ljk5NDZsLS4wMTYzOC0uMTgxMS0uMDAxMDYtLjA1MzIuMDAxNzgtLjAzOThjLjAyNTk4LS4yNzA2LjI1NDg3LS40ODIzLjUzMjg5LS40ODIzeiIgZmlsbD0iI2FmZDhmNyIvPjxwYXRoIGQ9Im00LjMwMDA5IDFjMy43ODc1NSAwIDYuODI1ODEgMi45MDkxMSA2LjgyNTgxIDYuNTAyNzd2Ni4zNTM0M2MtLjAwMDQuMjkxNy0uMjM5Mi41Mjg0LS41MzQuNTI4OGwtNi4wNTc1OC4wMDMyYy0uMjk1MTEuMDAwNy0uNTM0MzItLjIzNjEtLjUzNDMyLS41Mjc4bC4wMDAzNi0xMi41NjM3NWMwLS4xNTE0OS4xMTQyNi0uMjc2MjIuMjYxOTktLjI5NDE4eiIgZmlsbD0iIzE4MmE3MSIvPjxwYXRoIGQ9Im0xOS42OTIxIDEyLjIzODMuMDM4OC4xMjgzLS4wMjg4LS4wODQ2Yy4xNjE2LjQ1MzQuMjY2Ni43NzY5LjMxNTMgMS4zNDEzLjAzMzUuMzg3OS0uMjU3LjcyODktLjY0ODUuNzYybC0uMDMwMy4wMDIyLTMuMDgwOS4wMDA3Yy0yLjEwNjMgMC0zLjgyMDQtMS40NzQxLTMuODc1Mi0zLjU0MjNsLS4wMDE0LS4xMDIxdi0zLjQ2NThjMC0uMjAxNTMuMTY5NC0uMzY5NTkuMzc0MS0uMzYwMDcgMy4zMDAzLjE1NDY2IDUuOTk3OCAyLjM0MTUxIDYuOTM2OSA1LjMyMDM3eiIgZmlsbD0iIzM0ODVjNCIvPjwvZz48L3N2Zz4=';\n    this.supportedTransactionVersions = null;\n    this._readyState = typeof window === 'undefined' || typeof document === 'undefined' ? WalletReadyState.Unsupported : WalletReadyState.Loadable;\n    this._connecting = false;\n    this._wallet = null;\n    this._publicKey = null;\n    this._network = config.network || WalletAdapterNetwork.Mainnet;\n  }\n  get publicKey() {\n    return this._publicKey;\n  }\n  get connecting() {\n    return this._connecting;\n  }\n  get readyState() {\n    return this._readyState;\n  }\n  async connect() {\n    try {\n      if (this.connected || this.connecting) return;\n      if (this._readyState !== WalletReadyState.Loadable) throw new WalletNotReadyError();\n      this._connecting = true;\n      let BloctoClass;\n      try {\n        BloctoClass = (await import('@blocto/sdk')).default;\n      } catch (error) {\n        throw new WalletLoadError(error?.message, error);\n      }\n      let wallet;\n      try {\n        wallet = new BloctoClass({\n          solana: {\n            net: this._network\n          }\n        }).solana;\n      } catch (error) {\n        throw new WalletConfigError(error?.message, error);\n      }\n      if (!wallet) throw new WalletConfigError();\n      if (!wallet.connected) {\n        try {\n          await wallet.connect();\n        } catch (error) {\n          throw new WalletConnectionError(error?.message, error);\n        }\n      }\n      const account = wallet.accounts[0];\n      if (!account) throw new WalletAccountError();\n      let publicKey;\n      try {\n        publicKey = new PublicKey(account);\n      } catch (error) {\n        throw new WalletPublicKeyError(error?.message, error);\n      }\n      this._wallet = wallet;\n      this._publicKey = publicKey;\n      this.emit('connect', publicKey);\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    } finally {\n      this._connecting = false;\n    }\n  }\n  async disconnect() {\n    const wallet = this._wallet;\n    if (wallet) {\n      this._wallet = null;\n      this._publicKey = null;\n      try {\n        await wallet.disconnect();\n      } catch (error) {\n        this.emit('error', new WalletDisconnectionError(error?.message, error));\n      }\n    }\n    this.emit('disconnect');\n  }\n  async sendTransaction(transaction, connection) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    try {\n      const wallet = this._wallet;\n      if (!wallet) throw new WalletNotConnectedError();\n      try {\n        const {\n          signers,\n          ...sendOptions\n        } = options;\n        transaction = await this.prepareTransaction(transaction, connection, sendOptions);\n        if (signers?.length) {\n          transaction = await wallet.convertToProgramWalletTransaction(transaction);\n          transaction.partialSign(...signers);\n        }\n        return await wallet.signAndSendTransaction(transaction, connection);\n      } catch (error) {\n        if (error instanceof WalletError) throw error;\n        throw new WalletSendTransactionError(error?.message, error);\n      }\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n}","map":{"version":3,"mappings":"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","names":["BaseWalletAdapter","WalletAccountError","WalletAdapterNetwork","WalletConfigError","WalletConnectionError","WalletDisconnectionError","WalletError","WalletLoadError","WalletNotConnectedError","WalletNotReadyError","WalletPublicKeyError","WalletReadyState","WalletSendTransactionError","PublicKey","BloctoWalletName","BloctoWalletAdapter","constructor","config","window","document","Unsupported","Loadable","_connecting","_wallet","_publicKey","_network","network","Mainnet","publicKey","connecting","readyState","_readyState","connect","connected","BloctoClass","default","error","message","wallet","solana","net","account","accounts","emit","disconnect","sendTransaction","transaction","connection","options","signers","sendOptions","prepareTransaction","length","convertToProgramWalletTransaction","partialSign","signAndSendTransaction"],"sourceRoot":"","sources":["../../src/adapter.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}