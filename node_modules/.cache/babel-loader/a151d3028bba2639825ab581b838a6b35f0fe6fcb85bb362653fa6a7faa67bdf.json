{"ast":null,"code":"import { BaseMessageSignerWalletAdapter, scopePollingDetectionStrategy, WalletAccountError, WalletConnectionError, WalletDisconnectedError, WalletDisconnectionError, WalletError, WalletNotConnectedError, WalletNotReadyError, WalletPublicKeyError, WalletReadyState, WalletSendTransactionError, WalletSignMessageError, WalletSignTransactionError } from '@solana/wallet-adapter-base';\nimport { PublicKey } from '@solana/web3.js';\nexport const TokenaryWalletName = 'Tokenary';\nexport class TokenaryWalletAdapter extends BaseMessageSignerWalletAdapter {\n  constructor() {\n    let config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    super();\n    this.name = TokenaryWalletName;\n    this.url = 'https://tokenary.io/get';\n    this.icon = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzRweCIgaGVpZ2h0PSIzNHB4IiB2aWV3Qm94PSIwIDAgMzQgMzQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+T3ZhbDwvdGl0bGU+CiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8Y2lyY2xlIGlkPSJPdmFsIiBmaWxsPSIjMkM3Q0Y1IiBjeD0iMTciIGN5PSIxNyIgcj0iMTciPjwvY2lyY2xlPgogICAgPC9nPgo8L3N2Zz4=';\n    this.supportedTransactionVersions = null;\n    this._readyState = typeof window === 'undefined' || typeof document === 'undefined' ? WalletReadyState.Unsupported : WalletReadyState.NotDetected;\n    this._disconnected = () => {\n      const wallet = this._wallet;\n      if (wallet) {\n        wallet.off('disconnect', this._disconnected);\n        this._wallet = null;\n        this._publicKey = null;\n        this.emit('error', new WalletDisconnectedError());\n        this.emit('disconnect');\n      }\n    };\n    this._connecting = false;\n    this._wallet = null;\n    this._publicKey = null;\n    if (this._readyState !== WalletReadyState.Unsupported) {\n      scopePollingDetectionStrategy(() => {\n        if (window.tokenarySolana?.isTokenary) {\n          this._readyState = WalletReadyState.Installed;\n          this.emit('readyStateChange', this._readyState);\n          return true;\n        }\n        return false;\n      });\n    }\n  }\n  get publicKey() {\n    return this._publicKey;\n  }\n  get connecting() {\n    return this._connecting;\n  }\n  get connected() {\n    return !!this._wallet?.isConnected;\n  }\n  get readyState() {\n    return this._readyState;\n  }\n  async connect() {\n    try {\n      if (this.connected || this.connecting) return;\n      if (this._readyState !== WalletReadyState.Installed) throw new WalletNotReadyError();\n      this._connecting = true;\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      const wallet = window.tokenarySolana;\n      try {\n        await wallet.connect();\n      } catch (error) {\n        throw new WalletConnectionError(error?.message, error);\n      }\n      if (!wallet.publicKey) throw new WalletAccountError();\n      let publicKey;\n      try {\n        publicKey = new PublicKey(wallet.publicKey.toBytes());\n      } catch (error) {\n        throw new WalletPublicKeyError(error?.message, error);\n      }\n      wallet.on('disconnect', this._disconnected);\n      this._wallet = wallet;\n      this._publicKey = publicKey;\n      this.emit('connect', publicKey);\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    } finally {\n      this._connecting = false;\n    }\n  }\n  async disconnect() {\n    const wallet = this._wallet;\n    if (wallet) {\n      wallet.off('disconnect', this._disconnected);\n      this._wallet = null;\n      this._publicKey = null;\n      try {\n        await wallet.disconnect();\n      } catch (error) {\n        this.emit('error', new WalletDisconnectionError(error?.message, error));\n      }\n    }\n    this.emit('disconnect');\n  }\n  async sendTransaction(transaction, connection) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    try {\n      const wallet = this._wallet;\n      if (!wallet) throw new WalletNotConnectedError();\n      try {\n        const {\n          signers,\n          ...sendOptions\n        } = options;\n        transaction = await this.prepareTransaction(transaction, connection, sendOptions);\n        signers?.length && transaction.partialSign(...signers);\n        sendOptions.preflightCommitment = sendOptions.preflightCommitment || connection.commitment;\n        const {\n          signature\n        } = await wallet.signAndSendTransaction(transaction, sendOptions);\n        return signature;\n      } catch (error) {\n        if (error instanceof WalletError) throw error;\n        throw new WalletSendTransactionError(error?.message, error);\n      }\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n  async signTransaction(transaction) {\n    try {\n      const wallet = this._wallet;\n      if (!wallet) throw new WalletNotConnectedError();\n      try {\n        return (await wallet.signTransaction(transaction)) || transaction;\n      } catch (error) {\n        throw new WalletSignTransactionError(error?.message, error);\n      }\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n  async signAllTransactions(transactions) {\n    try {\n      const wallet = this._wallet;\n      if (!wallet) throw new WalletNotConnectedError();\n      try {\n        return (await wallet.signAllTransactions(transactions)) || transactions;\n      } catch (error) {\n        throw new WalletSignTransactionError(error?.message, error);\n      }\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n  async signMessage(message) {\n    try {\n      const wallet = this._wallet;\n      if (!wallet) throw new WalletNotConnectedError();\n      try {\n        const {\n          signature\n        } = await wallet.signMessage(message);\n        return signature;\n      } catch (error) {\n        throw new WalletSignMessageError(error?.message, error);\n      }\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n}","map":{"version":3,"mappings":"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","names":["BaseMessageSignerWalletAdapter","scopePollingDetectionStrategy","WalletAccountError","WalletConnectionError","WalletDisconnectedError","WalletDisconnectionError","WalletError","WalletNotConnectedError","WalletNotReadyError","WalletPublicKeyError","WalletReadyState","WalletSendTransactionError","WalletSignMessageError","WalletSignTransactionError","PublicKey","TokenaryWalletName","TokenaryWalletAdapter","constructor","config","window","document","Unsupported","NotDetected","wallet","_wallet","off","_disconnected","_publicKey","emit","_connecting","_readyState","tokenarySolana","isTokenary","Installed","publicKey","connecting","connected","isConnected","readyState","connect","error","message","toBytes","on","disconnect","sendTransaction","transaction","connection","options","signers","sendOptions","prepareTransaction","length","partialSign","preflightCommitment","commitment","signature","signAndSendTransaction","signTransaction","signAllTransactions","transactions","signMessage"],"sourceRoot":"","sources":["../../src/adapter.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}