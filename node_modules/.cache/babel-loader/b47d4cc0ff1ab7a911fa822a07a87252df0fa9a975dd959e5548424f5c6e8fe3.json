{"ast":null,"code":"var __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;\n};\nvar __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _AppReadyEvent_detail;\nlet wallets = undefined;\nconst registered = new Set();\nconst listeners = {};\n/**\n * Get an API for {@link Wallets.get | getting}, {@link Wallets.on | listening for}, and\n * {@link Wallets.register | registering} {@link \"@wallet-standard/base\".Wallet | Wallets}.\n *\n * When called for the first time --\n *\n * This dispatches a {@link \"@wallet-standard/base\".WindowAppReadyEvent} to notify each Wallet that the app is ready\n * to register it.\n *\n * This also adds a listener for {@link \"@wallet-standard/base\".WindowRegisterWalletEvent} to listen for a notification\n * from each Wallet that the Wallet is ready to be registered by the app.\n *\n * This combination of event dispatch and listener guarantees that each Wallet will be registered synchronously as soon\n * as the app is ready whether the app loads before or after each Wallet.\n *\n * @return API for getting, listening for, and registering Wallets.\n *\n * @group App\n */\nexport function getWallets() {\n  if (wallets) return wallets;\n  wallets = Object.freeze({\n    register,\n    get,\n    on\n  });\n  if (typeof window === 'undefined') return wallets;\n  const api = Object.freeze({\n    register\n  });\n  try {\n    window.addEventListener('wallet-standard:register-wallet', _ref => {\n      let {\n        detail: callback\n      } = _ref;\n      return callback(api);\n    });\n  } catch (error) {\n    console.error('wallet-standard:register-wallet event listener could not be added\\n', error);\n  }\n  try {\n    window.dispatchEvent(new AppReadyEvent(api));\n  } catch (error) {\n    console.error('wallet-standard:app-ready event could not be dispatched\\n', error);\n  }\n  return wallets;\n}\nfunction register() {\n  for (var _len = arguments.length, wallets = new Array(_len), _key = 0; _key < _len; _key++) {\n    wallets[_key] = arguments[_key];\n  }\n  // Filter out wallets that have already been registered.\n  // This prevents the same wallet from being registered twice, but it also prevents wallets from being\n  // unregistered by reusing a reference to the wallet to obtain the unregister function for it.\n  wallets = wallets.filter(wallet => !registered.has(wallet));\n  // If there are no new wallets to register, just return a no-op unregister function.\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  if (!wallets.length) return () => {};\n  wallets.forEach(wallet => registered.add(wallet));\n  listeners['register']?.forEach(listener => guard(() => listener(...wallets)));\n  // Return a function that unregisters the registered wallets.\n  return function unregister() {\n    wallets.forEach(wallet => registered.delete(wallet));\n    listeners['unregister']?.forEach(listener => guard(() => listener(...wallets)));\n  };\n}\nfunction get() {\n  return [...registered];\n}\nfunction on(event, listener) {\n  listeners[event]?.push(listener) || (listeners[event] = [listener]);\n  // Return a function that removes the event listener.\n  return function off() {\n    listeners[event] = listeners[event]?.filter(existingListener => listener !== existingListener);\n  };\n}\nfunction guard(callback) {\n  try {\n    callback();\n  } catch (error) {\n    console.error(error);\n  }\n}\nclass AppReadyEvent extends Event {\n  constructor(api) {\n    super('wallet-standard:app-ready', {\n      bubbles: false,\n      cancelable: false,\n      composed: false\n    });\n    _AppReadyEvent_detail.set(this, void 0);\n    __classPrivateFieldSet(this, _AppReadyEvent_detail, api, \"f\");\n  }\n  get detail() {\n    return __classPrivateFieldGet(this, _AppReadyEvent_detail, \"f\");\n  }\n  get type() {\n    return 'wallet-standard:app-ready';\n  }\n  /** @deprecated */\n  preventDefault() {\n    throw new Error('preventDefault cannot be called');\n  }\n  /** @deprecated */\n  stopImmediatePropagation() {\n    throw new Error('stopImmediatePropagation cannot be called');\n  }\n  /** @deprecated */\n  stopPropagation() {\n    throw new Error('stopPropagation cannot be called');\n  }\n}\n_AppReadyEvent_detail = new WeakMap();\n/**\n * @deprecated Use {@link getWallets} instead.\n *\n * @group Deprecated\n */\nexport function DEPRECATED_getWallets() {\n  if (wallets) return wallets;\n  wallets = getWallets();\n  if (typeof window === 'undefined') return wallets;\n  const callbacks = window.navigator.wallets || [];\n  if (!Array.isArray(callbacks)) {\n    console.error('window.navigator.wallets is not an array');\n    return wallets;\n  }\n  const {\n    register\n  } = wallets;\n  const push = function () {\n    for (var _len2 = arguments.length, callbacks = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      callbacks[_key2] = arguments[_key2];\n    }\n    return callbacks.forEach(callback => guard(() => callback({\n      register\n    })));\n  };\n  try {\n    Object.defineProperty(window.navigator, 'wallets', {\n      value: Object.freeze({\n        push\n      })\n    });\n  } catch (error) {\n    console.error('window.navigator.wallets could not be set');\n    return wallets;\n  }\n  push(...callbacks);\n  return wallets;\n}","map":{"version":3,"mappings":"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","names":["wallets","undefined","registered","Set","listeners","getWallets","Object","freeze","register","get","on","window","api","addEventListener","detail","callback","error","console","dispatchEvent","AppReadyEvent","filter","wallet","has","length","forEach","add","listener","guard","unregister","delete","event","push","off","existingListener","Event","constructor","bubbles","cancelable","composed","_AppReadyEvent_detail","__classPrivateFieldSet","__classPrivateFieldGet","type","preventDefault","Error","stopImmediatePropagation","stopPropagation","DEPRECATED_getWallets","callbacks","navigator","Array","isArray","defineProperty","value"],"sourceRoot":"","sources":["../../src/wallets.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}