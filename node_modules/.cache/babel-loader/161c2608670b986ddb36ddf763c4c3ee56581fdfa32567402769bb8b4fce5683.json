{"ast":null,"code":"import { BaseSignerWalletAdapter, scopePollingDetectionStrategy, WalletAccountError, WalletNotConnectedError, WalletNotReadyError, WalletPublicKeyError, WalletReadyState, WalletSignTransactionError } from '@solana/wallet-adapter-base';\nimport { PublicKey } from '@solana/web3.js';\nexport const SafePalWalletName = 'SafePal';\nexport class SafePalWalletAdapter extends BaseSignerWalletAdapter {\n  constructor() {\n    let config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    super();\n    this.name = SafePalWalletName;\n    this.url = 'https://safepal.io';\n    this.icon = 'data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI1NiIgdmlld0JveD0iMCAwIDI1NiAyNTYiIHdpZHRoPSIyNTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJtMjU2IDEyOGMwIDcwLjY5Mzg3My01Ny4zMDc5MzMgMTI4LTEyOCAxMjgtNzAuNjkyMDY2NyAwLTEyOC01Ny4zMDYxMjctMTI4LTEyOCAwLTcwLjY5MjA2NjcgNTcuMzA3OTMzMy0xMjggMTI4LTEyOCA3MC42OTIwNjcgMCAxMjggNTcuMzA3OTMzMyAxMjggMTI4IiBmaWxsPSIjMDAwIi8+PHBhdGggZD0ibTIwMC45OTE0OTkgMTQxLjM4NDM3OXYxMS45MzQ0MDRjMCAzMi40OTcwNzgtNDYuMjA1ODI2IDUxLjQ3NTM0Ni02MS45MzUzOTggNTYuOTg2NTMybC02LjI4OTM3MSAyLjE3NDY4NXYtMjAuNjI5NDAxbDIuNjIxOTE2LS45ODkyOGMyMi43MTQ3NDUtOC41NDg4MzYgNDUuNjMyMjgyLTIzLjI5NTQ2NSA0Ni4wODgzNjEtMzcuMTIzNzg0bC4wMDY5MjItLjQxODc1MnYtMTEuOTM0NDA0em0tNzIuODY1MTcyLTk3Ljg2NDM3OSAxOS42NjExMzUgNi4wNjMzODIydjIxLjA0ODA2N2wtMTkuNjYxMTM1LTYuMDg0Mzk2My0xLjI4NjcxMS4zOTkyNjgzdjQ3LjM1NDUxMzhoMjAuOTQ3ODQ2djE5LjUxMDgwM2gtMjAuOTQ3ODQ2djgwLjM4MDYzbC02LjM2Mjg5Mi0yLjM3NTQ2N2MtMi40NDg2MzUtLjkyODUwMi01Ljk3MzE2Ny0yLjMzOTg4Ni0xMC4yMTU4NzUtNC4yNDkxNDJsLS41NTc0NC0uMjUxODU4LTIuMzc0NTk2LTEuMDg0NjUydi0xNTQuMjkzNzU5N3ptLTI2Ljk2OTIgOC40MDA0NzU4djIwLjk1MTA3ODhsLTI2LjY0MTA1NTggOC4yNjk4NjQ5djMxLjE1OTA5MjVoMjYuNjQxMDU1OHY5MC4yNDI3MThsLTUuOTAwMTE4Mi0zLjAzNDExNWMtMTguMTc2Mjc3My05LjM1NTM5LTM5LjgxMTA4ODItMjUuMDcwMTczLTQwLjI0MTk2NjgtNDYuOTcwMjQ4bC0uMDA2NTQxMS0uNjY1NTMydi0xMC40ODkyOGgxOS41MDc1NzAzdjEwLjQ4OTI4YzAgNC40NjY3MzcgMi4yNTgyODY3IDkuMTU1OCA2LjcxODY5NjMgMTMuOTgyOTQ0bC40MTE1NTY2LjQzOTIwOXYtMzQuNDg0MTczaC0yNi42Mzc4MjMydi02NS42NDY0OTh6bTUyLjU1MjYtLjQ5OTE2NjIgNDcuMjgxNzcyIDE0LjYzMzkxMDZ2NjUuNzU2NDE3OGgtMjcuNzU4MDM3djI4LjQ3NTc1MWwtLjI4NTQ4OS4zNTQyMDZjLTEuMzU1MjUgMS42MzQ0NTUtNy41NjM1NzUgOC42MjI2NTUtMTkuMjIwNDY1IDE0LjU5NDkxNnptMTkuNTIzNzM1IDI3LjA3NzUwMzN2MzMuODAyMDIyMWg4LjI1MDQ2N3YtMzEuMjU0NDY0eiIgZmlsbD0iI2ZmZiIvPjwvZz48L3N2Zz4=';\n    this.supportedTransactionVersions = null;\n    this._readyState = typeof window === 'undefined' || typeof document === 'undefined' ? WalletReadyState.Unsupported : WalletReadyState.NotDetected;\n    this._connecting = false;\n    this._wallet = null;\n    this._publicKey = null;\n    if (this._readyState !== WalletReadyState.Unsupported) {\n      scopePollingDetectionStrategy(() => {\n        if (window.safepal?.isSafePalWallet) {\n          this._readyState = WalletReadyState.Installed;\n          this.emit('readyStateChange', this._readyState);\n          return true;\n        }\n        return false;\n      });\n    }\n  }\n  get publicKey() {\n    return this._publicKey;\n  }\n  get connecting() {\n    return this._connecting;\n  }\n  get readyState() {\n    return this._readyState;\n  }\n  async connect() {\n    try {\n      if (this.connected || this.connecting) return;\n      if (this._readyState !== WalletReadyState.Installed) throw new WalletNotReadyError();\n      this._connecting = true;\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      const wallet = window.safepal;\n      let account;\n      try {\n        account = await wallet.getAccount();\n      } catch (error) {\n        throw new WalletAccountError(error?.message, error);\n      }\n      let publicKey;\n      try {\n        publicKey = new PublicKey(account);\n      } catch (error) {\n        throw new WalletPublicKeyError(error?.message, error);\n      }\n      this._wallet = wallet;\n      this._publicKey = publicKey;\n      this.emit('connect', publicKey);\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    } finally {\n      this._connecting = false;\n    }\n  }\n  async disconnect() {\n    if (this._wallet) {\n      this._wallet = null;\n      this._publicKey = null;\n    }\n    this.emit('disconnect');\n  }\n  async signTransaction(transaction) {\n    try {\n      const wallet = this._wallet;\n      if (!wallet) throw new WalletNotConnectedError();\n      try {\n        return await wallet.signTransaction(transaction);\n      } catch (error) {\n        throw new WalletSignTransactionError(error?.message, error);\n      }\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n  async signAllTransactions(transactions) {\n    try {\n      const wallet = this._wallet;\n      if (!wallet) throw new WalletNotConnectedError();\n      try {\n        return await wallet.signAllTransactions(transactions);\n      } catch (error) {\n        throw new WalletSignTransactionError(error?.message, error);\n      }\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n}","map":{"version":3,"mappings":"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","names":["BaseSignerWalletAdapter","scopePollingDetectionStrategy","WalletAccountError","WalletNotConnectedError","WalletNotReadyError","WalletPublicKeyError","WalletReadyState","WalletSignTransactionError","PublicKey","SafePalWalletName","SafePalWalletAdapter","constructor","config","window","document","Unsupported","NotDetected","_connecting","_wallet","_publicKey","_readyState","safepal","isSafePalWallet","Installed","emit","publicKey","connecting","readyState","connect","connected","wallet","account","getAccount","error","message","disconnect","signTransaction","transaction","signAllTransactions","transactions"],"sourceRoot":"","sources":["../../src/adapter.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}